# Use shared base image with built database package
FROM branvia-base AS base

# Build stage
FROM base AS builder
WORKDIR /app/web

# Copy the web directory contents
COPY web/ ./

# Copy .env file for build stage
COPY .env ./

# Install ALL dependencies (including dev dependencies for building)
RUN pnpm install

# Build the web app (with dotenv loading environment variables)
RUN pnpm dotenv -e .env pnpm run build
